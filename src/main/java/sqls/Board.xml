<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Board">

<!-- 
boardlist
boardwrite
getboard
boardcountup
boardupdate
boarddelete 
-->
        
<select id="boardlist" parameterType="secure.mbti.a.dto.BoardParam" resultType="secure.mbti.a.dto.BoardDto">
	SELECT BOARDSEQ, ID, BOARDTYPE, TITLE, CONTENT, READCOUNT, COMMENTCOUNT, WDATE, DEL,
	FROM BOARDALL
	<if test="choice != null and choice != '' and search !=null and search !='' "> <!-- 조건문이 들어감 -->
		<if test="choice == 'title'">
			WHERE TITLE LIKE '%'||#{search}||'%'      <!-- 어느위치에 있던 단어가 들어있는것을 찾음 ||는 더하기임 -->
		</if>
		<if test="choice == 'content'">
			WHERE CONTENT LIKE '%'||#{search}||'%' 
		</if>
		<if test="choice == 'writer'">
			WHERE ID=#{search}                        <!-- abc를 찾을껀데 abcd도 나와서 -->
		</if>
	</if>
	ORDER BY REF DESC, STEP ASC
</select>

<insert id="boardwrite" parameterType="secure.mbti.a.dto.BoardDto">
	INSERT INTO BOARDALL(BOARDSEQ, ID, BOARDTYPE, COMMENTCOUNT, TITLE, CONTENT, WDATE, DEL, READCOUNT)
	VALUES(
	BOARDSEQ_BOARDALL.NEXTVAL,
	 #{id},
	 #{boardtype},
	 0,
	  #{title},
	  #{content},
	  SYSDATE, 
	  0, 
	  0,
	);
</insert>

<select id="getboard" resultType="secure.mbti.a.dto.BoardDto">
	SELECT BOARDSEQ, ID, BOARDTYPE, COMMENTCOUNT, TITLE, CONTENT, WDATE, DEL, READCOUNT
	FROM BOARDALL
	WHERE BOARDSEQ=#{boardseq}
</select>
        
<update id="boardcountup" parameterType="Integer" >
	UPDATE BOARDALL
	SET
	READCOUNT = READCOUNT + 1
	WHERE BOARDSEQ = #{ boardseq }
</update>                


<update id="boardupdate" parameterType="secure.mbti.a.dto.BoardDto">
	UPDATE BOARDALL
	SET TITLE = #{title}, CONTENT=#{content}
	WHERE BOARDSEQ=#{boardseq}
</update>

<update id="boarddelete" parameterType="Integer" >
	UPDATE BOARDALL
	SET DEL=1
	WHERE BOARDSEQ=#{boardseq}
</update>
     
     
     

</mapper>